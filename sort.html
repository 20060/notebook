<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title></title>
    <style media="screen">
      ul {
        list-style-type: none;
      }
    </style>
  </head>
  <body>
    <ul id="output">
    </ul>
    <script type="text/javascript">
      function sort (rules, data, desc) {
        let func = (rules, data) => {
          let rule = rules[0]
          let result = []
          let mapping = new Map()

          data.sort((a, b) => a[rule] < b[rule]).map(({[rule]: key}, index, data) => {
            let arr
            if (mapping.has(key)) {
              arr = mapping.get(key)
            } else {
              arr = []
              result.push(arr)
              mapping.set(key, arr)
            }
            arr.push(data[index])
          })

          let ruleList = rules.slice(1)
          if (ruleList.length) {

            for (let key in result) {
              result[key] = func(rules.slice(1), result[key])
            }
          }
          return result
        }

        let toArray = (rules, data) => {
          let rule = rules[0]
          let ruleList = rules.slice(1)

          var result = []

          for (let item of data) {
            if (Array.isArray(item)) {
              result = result.concat(toArray(ruleList, item))
            } else {
              result.push(item)
            }
          }
          return result
        }


        if (typeof rules === 'string') {
          if (/\w+\,\w+/.test(rules)) {
            rules = rules.split(',')
          } else {
            rules = [rules]
          }
        }

        let result = toArray(rules, func(rules, data))

        return desc ? result.reverse() : result
      }

      var data = [
        {
          age: 20,
          name: 'cc',
          price: 20
        },
        {
          age: 18,
          name: 'ab',
          price: 233
        },
        {
          age: 20,
          name: 'aa',
          price: 233
        },
        {
          age: 20,
          name: 'cc',
          price: 1000
        },
        {
          age: 20,
          name: 'aa',
          price: 1000
        }
      ]

      var arr = sort('age,name,price', data, true)
      arr.forEach(item => {
        document.querySelector('#output').innerHTML += `
          <li>
          ${JSON.stringify(item, null, 2).replace(/\n/g, '<br/>').replace(/\s/g, '&nbsp;')}
          </li>
        `
      })
    </script>
  </body>
</html>
